
> news-api@1.0.0 test
> jest --forceExit --detectOpenHandles

node.exe : FAIL src/__tests__/dashboard.test.ts
At C:\Program Files\nodejs\npm.ps1:29 char:3
+   & $NODE_EXE $NPM_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (FAIL 
src/__tests__/dashboard.test.    ts:String) [], 
RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
  ΓùÅ GET /api/v1/author/dashboard ΓÇö Story 7: 
Author Performance Dashboard ΓÇ║ should return 
paginated dashboard items with TotalViews for an 
Author

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 403

    [0m [90m 56 |[39m             [33m.[39m[36
mset[39m([32m'Authorization'[39m[33m,[39m 
[32m'Bearer mock_author_token'[39m)[33m;[39m
     [90m 57 |[39m
    [31m[1m>[22m[39m[90m 58 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 59 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
true[39m)[33m;[39m
     [90m 60 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mObject[39m)[33m.[39mtoHaveLengt
h([35m1[39m)[33m;[39m
     [90m 61 |[39m         [90m// Verify 
TotalViews is a number (summed analytics)[39m[0m

      at Object.<anonymous> 
(src/__tests__/dashboard.test.ts:58:28)

  ΓùÅ GET /api/v1/author/dashboard ΓÇö Story 7: 
Author Performance Dashboard ΓÇ║ should return 
paginated items when author has 0 articles

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 403

    [0m [90m 75 |[39m             [33m.[39m[36
mset[39m([32m'Authorization'[39m[33m,[39m 
[32m'Bearer mock_author_token'[39m)[33m;[39m
     [90m 76 |[39m
    [31m[1m>[22m[39m[90m 77 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 78 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
true[39m)[33m;[39m
     [90m 79 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mObject[39m)[33m.[39mtoEqual([])
[33m;[39m
     [90m 80 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mTotalSize[39m)[33m.[39mtoBe([3
5m0[39m)[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/dashboard.test.ts:77:28)

  ΓùÅ GET /api/v1/author/dashboard ΓÇö Story 7: 
Author Performance Dashboard ΓÇ║ should support 
custom pagination (page=2&size=5)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 403

    [0m [90m 90 |[39m             [33m.[39m[36
mset[39m([32m'Authorization'[39m[33m,[39m 
[32m'Bearer mock_author_token'[39m)[33m;[39m
     [90m 91 |[39m
    [31m[1m>[22m[39m[90m 92 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 93 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mPageNumber[39m)[33m.[39mtoBe([
35m2[39m)[33m;[39m
     [90m 94 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mPageSize[39m)[33m.[39mtoBe([35
m5[39m)[33m;[39m
     [90m 95 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/dashboard.test.ts:92:28)

FAIL src/__tests__/articles.test.ts
  ΓùÅ POST /api/v1/articles ΓÇö Story 3: Create 
Article ΓÇ║ should create an article and return 201 
for an Author

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 201
    Received: 403

    [0m [90m 70 |[39m             
[33m.[39msend(createBody)[33m;[39m
     [90m 71 |[39m
    [31m[1m>[22m[39m[90m 72 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m201[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 73 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
true[39m)[33m;[39m
     [90m 74 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mObject[39m)[33m.[39mtoMatchObje
ct({ title[33m:[39m createBody[33m.[39mtitle 
})[33m;[39m
     [90m 75 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:72:28)

  ΓùÅ POST /api/v1/articles ΓÇö Story 3: Create 
Article ΓÇ║ should return 422 if title is missing

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 403

    [0m [90m 102 |[39m             
[33m.[39msend({ 
[33m...[39mcreateBody[33m,[39m title[33m:[39m 
[32m''[39m })[33m;[39m
     [90m 103 |[39m
    [31m[1m>[22m[39m[90m 104 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m422[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 105 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 106 |[39m     })[33m;[39m
     [90m 107 |[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:104:28)

  ΓùÅ POST /api/v1/articles ΓÇö Story 3: Create 
Article ΓÇ║ should return 422 if content is shorter 
than 50 characters

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 403

    [0m [90m 114 |[39m             
[33m.[39msend({ 
[33m...[39mcreateBody[33m,[39m 
content[33m:[39m [32m'Too short.'[39m 
})[33m;[39m
     [90m 115 |[39m
    [31m[1m>[22m[39m[90m 116 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m422[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 117 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 118 |[39m     })[33m;[39m
     [90m 119 |[39m })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:116:28)

  ΓùÅ GET /api/v1/articles/me ΓÇö Story 8: Author's 
Own Articles ΓÇ║ should return paginated list of 
author's own articles (including drafts)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 403

    [0m [90m 134 |[39m             [33m.[39m[3
6mset[39m([32m'Authorization'[39m[33m,[39m 
authorToken)[33m;[39m
     [90m 135 |[39m
    [31m[1m>[22m[39m[90m 136 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 137 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
     [90m 138 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mObject[39m)[33m.[39mtoHaveLeng
th([35m2[39m)[33m;[39m
     [90m 139 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mPageNumber[39m)[33m.[39mtoBe(
[35m1[39m)[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:136:28)

  ΓùÅ PUT /api/v1/articles/:id ΓÇö Story 3: Update 
Article ΓÇ║ should update an article if the Author 
owns it

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 403

    [0m [90m 176 |[39m             
[33m.[39msend({ title[33m:[39m [32m'Updated 
Title'[39m })[33m;[39m
     [90m 177 |[39m
    [31m[1m>[22m[39m[90m 178 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 179 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
     [90m 180 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mObject[39m[33m.[39mtitle)[33m
.[39mtoBe([32m'Updated Title'[39m)[33m;[39m
     [90m 181 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:178:28)

  ΓùÅ PUT /api/v1/articles/:id ΓÇö Story 3: Update 
Article ΓÇ║ should return 403 if an Author tries to 
edit another Author's article

    expect(received).toEqual(expected) // deep 
equality

    Expected: ArrayContaining [StringContaining 
"own articles"]
    Received: ["You do not have permission to 
access this resource"]

    [0m [90m 192 |[39m         expect(res[33m.[
39mstatus)[33m.[39mtoBe([35m403[39m)[33m;[39m
     [90m 193 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 194 |[39m         exp
ect(res[33m.[39mbody[33m.[39m[33mErrors[39m)[
33m.[39mtoEqual(
     [90m     |[39m                               
  [31m[1m^[22m[39m
     [90m 195 |[39m             expect[33m.[39ma
rrayContaining([expect[33m.[39mstringContaining([
32m'own articles'[39m)])
     [90m 196 |[39m         )[33m;[39m
     [90m 197 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:194:33)

  ΓùÅ PUT /api/v1/articles/:id ΓÇö Story 3: Update 
Article ΓÇ║ should return 404 if article does not 
exist

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 404
    Received: 403

    [0m [90m 206 |[39m             
[33m.[39msend({ title[33m:[39m [32m'New 
Title'[39m })[33m;[39m
     [90m 207 |[39m
    [31m[1m>[22m[39m[90m 208 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m404[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 209 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 210 |[39m     })[33m;[39m
     [90m 211 |[39m })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:208:28)

  ΓùÅ DELETE /api/v1/articles/:id ΓÇö Story 3: Soft 
Delete ΓÇ║ should soft-delete an article (set 
deletedAt) and return 200

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 403

    [0m [90m 228 |[39m             [33m.[39m[3
6mset[39m([32m'Authorization'[39m[33m,[39m 
authorToken)[33m;[39m
     [90m 229 |[39m
    [31m[1m>[22m[39m[90m 230 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 231 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
     [90m 232 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mMessage[39m)[33m.[39mtoMatch(
[35m/deleted/i[39m)[33m;[39m
     [90m 233 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:230:28)

  ΓùÅ GET /api/v1/articles ΓÇö Story 4: Public News 
Feed ΓÇ║ should return paginated published articles 
(default page=1, size=10)

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 2
    Received array:  [{"author": {"email": 
"alice@example.com", "id": "author-uuid-1", "name": 
"Alice Smith"}, "authorId": "author-uuid-1", 
"category": "Tech", "content": "This is a long 
enough content for the article to pass validation 
checks.", "createdAt": "2025-01-01T00:00:00.000Z", 
"deletedAt": null, "id": "article-uuid-1", 
"status": "Published", "title": "Breaking News 
Today"}, {"author": {"email": "alice@example.com", 
"id": "author-uuid-1", "name": "Alice Smith"}, 
"authorId": "author-uuid-1", "category": "Tech", 
"content": "This is a long enough content for the 
article to pass validation checks.", "createdAt": 
"2025-01-01T00:00:00.000Z", "deletedAt": null, 
"id": "article-uuid-1", "status": "Draft", "title": 
"Breaking News Today"}]

    [0m [90m 266 |[39m         expect(res[33m.[
39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m 267 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 268 |[39m         exp
ect(res[33m.[39mbody[33m.[39m[33mObject[39m)[
33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                               
  [31m[1m^[22m[39m
     [90m 269 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mPageNumber[39m)[33m.[39mtoBe(
[35m1[39m)[33m;[39m
     [90m 270 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mPageSize[39m)[33m.[39mtoBe([3
5m10[39m)[33m;[39m
     [90m 271 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mTotalSize[39m)[33m.[39mtoBe([
35m1[39m)[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:268:33)

  ΓùÅ GET /api/v1/articles/:id ΓÇö Story 5: Read 
Article + Tracking ΓÇ║ should return the article 
and record a read log (guest user)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 500

    [0m [90m 327 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39m[36mget[39m([32m`/api/v1/articles/${fakeArticl
e.id}`[39m)[33m;[39m
     [90m 328 |[39m
    [31m[1m>[22m[39m[90m 329 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 330 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
     [90m 331 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mObject[39m)[33m.[39mtoMatchObj
ect({ id[33m:[39m 
fakeArticle[33m.[39mid[33m,[39m 
title[33m:[39m fakeArticle[33m.[39mtitle 
})[33m;[39m
     [90m 332 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:329:28)

  ΓùÅ GET /api/v1/articles/:id ΓÇö Story 5: Read 
Article + Tracking ΓÇ║ should record a read log 
with readerId if the user is authenticated

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 500

    [0m [90m 341 |[39m             [33m.[39m[3
6mset[39m([32m'Authorization'[39m[33m,[39m 
readerToken)[33m;[39m
     [90m 342 |[39m
    [31m[1m>[22m[39m[90m 343 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 344 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
     [90m 345 |[39m     })[33m;[39m
     [90m 346 |[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:343:28)

  ΓùÅ GET /api/v1/articles/:id ΓÇö Story 5: Read 
Article + Tracking ΓÇ║ should return 404 if article 
does not exist

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 404
    Received: 500

    [0m [90m 350 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39m[36mget[39m([32m'/api/v1/articles/nonexistent-
uuid'[39m)[33m;[39m
     [90m 351 |[39m
    [31m[1m>[22m[39m[90m 352 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m404[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 353 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 354 |[39m     })[33m;[39m
     [90m 355 |[39m[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:352:28)

  ΓùÅ GET /api/v1/articles/:id ΓÇö Story 5: Read 
Article + Tracking ΓÇ║ should return 410 if article 
is soft-deleted (no longer available)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 410
    Received: 500

    [0m [90m 362 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39m[36mget[39m([32m`/api/v1/articles/${fakeArticl
e.id}`[39m)[33m;[39m
     [90m 363 |[39m
    [31m[1m>[22m[39m[90m 364 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m410[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 365 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 366 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mErrors[39m)[33m.[39mtoEqual(
     [90m 367 |[39m             expect[33m.[39ma
rrayContaining([expect[33m.[39mstringContaining([
32m'no longer available'[39m)])[0m

      at Object.<anonymous> 
(src/__tests__/articles.test.ts:364:28)

FAIL src/__tests__/auth.test.ts
  ΓùÅ POST /api/v1/auth/signup ΓÇö User Story 1 ΓÇ║ 
should register a new user and return 201 with user 
object (no password)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 201
    Received: 500

    [0m [90m 54 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39mpost([32m'/api/v1/auth/signup'[39m)[33m.[39ms
end(validSignupBody)[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m201[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 57 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
true[39m)[33m;[39m
     [90m 58 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mObject[39m)[33m.[39mtoMatchObje
ct({
     [90m 59 |[39m             id[33m:[39m 
savedUser[33m.[39mid[33m,[39m[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:56:28)

  ΓùÅ POST /api/v1/auth/signup ΓÇö User Story 1 ΓÇ║ 
should return 409 when email already exists

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 409
    Received: 500

    [0m [90m 71 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39mpost([32m'/api/v1/auth/signup'[39m)[33m.[39ms
end(validSignupBody)[33m;[39m
     [90m 72 |[39m
    [31m[1m>[22m[39m[90m 73 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m409[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 74 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
false[39m)[33m;[39m
     [90m 75 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mErrors[39m)[33m.[39mtoEqual(
     [90m 76 |[39m             expect[33m.[39mar
rayContaining([expect[33m.[39mstringContaining([3
2m'already exists'[39m)])[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:73:28)

  ΓùÅ POST /api/v1/auth/signup ΓÇö User Story 1 ΓÇ║ 
should return 422 when name contains digits

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 500

    [0m [90m 83 |[39m             
[33m.[39msend({ 
[33m...[39mvalidSignupBody[33m,[39m 
name[33m:[39m [32m'Alice123'[39m })[33m;[39m
     [90m 84 |[39m
    [31m[1m>[22m[39m[90m 85 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m422[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 86 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
false[39m)[33m;[39m
     [90m 87 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mErrors[39m)[33m.[39mtoBeDefined
()[33m;[39m
     [90m 88 |[39m     })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:85:28)

  ΓùÅ POST /api/v1/auth/signup ΓÇö User Story 1 ΓÇ║ 
should return 422 when password is weak (missing 
uppercase)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 500

    [0m [90m 93 |[39m             
[33m.[39msend({ 
[33m...[39mvalidSignupBody[33m,[39m 
password[33m:[39m [32m'weakpass1!'[39m 
})[33m;[39m
     [90m 94 |[39m
    [31m[1m>[22m[39m[90m 95 |[39m         expe
ct(res[33m.[39mstatus)[33m.[39mtoBe([35m422[39
m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 96 |[39m         expect(res[33m.[39mbo
dy[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36m
false[39m)[33m;[39m
     [90m 97 |[39m     })[33m;[39m
     [90m 98 |[39m[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:95:28)

  ΓùÅ POST /api/v1/auth/signup ΓÇö User Story 1 ΓÇ║ 
should return 422 when role is invalid

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 500

    [0m [90m 102 |[39m             
[33m.[39msend({ 
[33m...[39mvalidSignupBody[33m,[39m 
role[33m:[39m [32m'Admin'[39m })[33m;[39m
     [90m 103 |[39m
    [31m[1m>[22m[39m[90m 104 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m422[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 105 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 106 |[39m     })[33m;[39m
     [90m 107 |[39m[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:104:28)

  ΓùÅ POST /api/v1/auth/signup ΓÇö User Story 1 ΓÇ║ 
should return 422 when email is malformed

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 500

    [0m [90m 111 |[39m             
[33m.[39msend({ 
[33m...[39mvalidSignupBody[33m,[39m 
email[33m:[39m [32m'not-an-email'[39m 
})[33m;[39m
     [90m 112 |[39m
    [31m[1m>[22m[39m[90m 113 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m422[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 114 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 115 |[39m     })[33m;[39m
     [90m 116 |[39m })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:113:28)

  ΓùÅ POST /api/v1/auth/login ΓÇö User Story 2 ΓÇ║ 
should return 200 with JWT token and user object on 
valid credentials

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 200
    Received: 401

    [0m [90m 129 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39mpost([32m'/api/v1/auth/login'[39m)[33m.[39mse
nd(loginBody)[33m;[39m
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 132 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mtrue[39m)[33m;[39m
     [90m 133 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mObject[39m)[33m.[39mtoHaveProp
erty([32m'token'[39m[33m,[39m 
[32m'fake_jwt_token'[39m)[33m;[39m
     [90m 134 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mObject[39m[33m.[39muser)[33m.
[39mtoMatchObject({[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:131:28)

  ΓùÅ POST /api/v1/auth/login ΓÇö User Story 2 ΓÇ║ 
should return 401 when email does not exist

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 401
    Received: 200

    [0m [90m 146 |[39m         [36mconst[39m 
res [33m=[39m [36mawait[39m request(app)[33m.[
39mpost([32m'/api/v1/auth/login'[39m)[33m.[39mse
nd(loginBody)[33m;[39m
     [90m 147 |[39m
    [31m[1m>[22m[39m[90m 148 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m401[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 149 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 150 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mErrors[39m)[33m.[39mtoEqual(
     [90m 151 |[39m             expect[33m.[39ma
rrayContaining([expect[33m.[39mstringContaining([
32m'Invalid email or password'[39m)])[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:148:28)

  ΓùÅ POST /api/v1/auth/login ΓÇö User Story 2 ΓÇ║ 
should return 422 when email field is missing

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 422
    Received: 500

    [0m [90m 168 |[39m             
[33m.[39msend({ password[33m:[39m 
[32m'StrongPass!1'[39m })[33m;[39m
     [90m 169 |[39m
    [31m[1m>[22m[39m[90m 170 |[39m         exp
ect(res[33m.[39mstatus)[33m.[39mtoBe([35m422[3
9m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 171 |[39m         expect(res[33m.[39mb
ody[33m.[39m[33mSuccess[39m)[33m.[39mtoBe([36
mfalse[39m)[33m;[39m
     [90m 172 |[39m     })[33m;[39m
     [90m 173 |[39m })[33m;[39m[0m

      at Object.<anonymous> 
(src/__tests__/auth.test.ts:170:28)

FAIL src/__tests__/setup.ts
  ΓùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/@jest/core/build/Tes
tScheduler.js:133:18)
      at node_modules/@jest/core/build/TestScheduler
.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit 
(node_modules/emittery/index.js:361:23)

Test Suites: 4 failed, 4 total
Tests:       25 failed, 13 passed, 38 total
Snapshots:   0 total
Time:        3.655 s
Ran all test suites.
